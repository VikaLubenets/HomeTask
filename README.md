# ШРИ Домашнее задание по автотестам

Тестовые файлы юнит-тестов лежат рядом с тестируемыми сущностями, тесты e2e лежат в корне проекта в папке e2e/tests

## Тестовые сценарии

### 1. Главная страница

- загрузка csv файла через drag&drop
    - ui тест наличия drag&drop на главной странице
        - unit tests
    - выбор файла ограничен расширением csv 
        - unit tests с ошибкой
    - e2e playwright test - пользователь перетаскивает корректный CSV-файл → файл загружается → отображается имя файла на кнопке
- загрузка csv файла через кнопку
    - наличие нужной кнопки 
        - unit tests
    - выбор файла ограничен расширением csv 
        - unit tests с ошибкой
    - e2e playwright test - пользователь выбирает корректный CSV-файл → файл загружается → отображается имя файла на кнопке
- отправка таблицы в систему
    - данные загружаются постепенно 
        - unit тесты api запроса 
        - unit тесты функции хелпера для последовательного чтения стрима
    - данные накапливаются плавно 
        - unit тесты изменения данных  
        - unit тесты ui отображения
        - unit тесты форматирования данных
    - есть индикатор загрузки
        - unit тесты на отображение loader
    - ошибка корректно отображается при сбое
        - unit тесты отображения кнопки ошибки
    - в localStorage сохраняется история
        - unit тесты работы класса с localStorage 
        - unit тесты изменения состояния localStorage после отработки запроса к апи
- кнопка очистить
    - пропадают хайлайты и подгруженный файл
        - unit тесты удаления ui компонентов с хайлайтами и установки базовой кнопки 

### 2. Навигационное меню
- роутинг работает, страницы переключаются
    - unit тесты роутера приложения по клику на кнопку навигации и отображения страниц
    - unit тесты ссылок в хедере
    - e2e playwright тест переключения страниц

### 3. Страница генерации
- при клике на кнопку отправляется запрос за генерацией
    - unit тесты api запроса генерации отчета
    - unit тесты отправки запроса по клику на кнопку
    - unit тесты обработки ошибки
- автоматически начинается загрузка файла
    - e2e тест автоматического скачивания файла - без мока апи вызова (см. комментрий в тесте)

### 4. Страница истории
- при загрузке страницы данные выгружаются из localStorage 
    - unit тест источника инициализации данных из ls
- страница инициализируется со списком
    - unit тест ui отображения страницы при пустом ls
    - unit тест ui отображения страницы при наличии списка
- удаление отдельных записей истории
    - unit тест по клику на кнопку удаления пропадает ui элемент строки со статусом успешно
    - unit тест по клику на кнопку удаления пропадает ui элемент строки со статусом неуспешно
    - unit тест по клику на кнопку удаления удаляется этот элемент из ls
- при клике на пункт списка открывается модальное окно с хайлайтами
    - unit тест по клику на строку с успешным статусом на странице появляется модальное окно
    - unit тест по клику на строку с неуспешным статусом на странице появляется модальное окно
    - unit тест модальное окно содержит хайлайты
    - e2e playwright тест открытия модального окна
- кнопка очистки истории очищает localStorage
    - unit тест очищения ls 
- кнопка "сгенерировать больше" редиректит на страницу генерации
    - unit тест изменения роутинга
- если история пустая, нет кнопки "очистить историю"
    - unit тест на отстутствие лишних элементов при пустой истории

## Инструкции по запуску

```bash
# Установка зависимостей
npm install

# Запуск unit-тестов
npm run test

# Установка браузеров для e2e
npm run test:e2e:install

# Запуск e2e-тестов
npm run test:e2e

# Запуск бекенда
cd /path-to-backend
npm i
npm run start
```

## Используемые технологии

### Unit-тестирование
- Vitest	
- React Testing Library

### End-to-End тестирование
- Playwright	

